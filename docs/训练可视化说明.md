# è®­ç»ƒå¯è§†åŒ–è¯´æ˜

## æ¦‚è¿°

ä¼˜åŒ–åçš„è®­ç»ƒè„šæœ¬æä¾›äº†ä¸°å¯Œçš„å¯è§†åŒ–åŠŸèƒ½ï¼š
- âœ… **è¿›åº¦æ¡æ˜¾ç¤º** - å®æ—¶æŸ¥çœ‹è®­ç»ƒè¿›åº¦
- âœ… **è®­ç»ƒæ›²çº¿** - è‡ªåŠ¨ç”ŸæˆLossã€å­¦ä¹ ç‡ç­‰æ›²çº¿å›¾
- âœ… **è®­ç»ƒå†å²** - ä¿å­˜å®Œæ•´è®­ç»ƒæ•°æ®åˆ°JSON
- âœ… **è®­ç»ƒæ—¥å¿—** - è¯¦ç»†çš„æ–‡æœ¬æ—¥å¿—è®°å½•
- âœ… **ETAé¢„ä¼°** - æ˜¾ç¤ºé¢„è®¡å‰©ä½™æ—¶é—´

## å®‰è£…ä¾èµ–

### æ–¹å¼1ï¼šå®Œæ•´å®‰è£…ï¼ˆæ¨èï¼‰

```bash
pip install -r requirements.txt
```

### æ–¹å¼2ï¼šæ‰‹åŠ¨å®‰è£…

```bash
# åŸºç¡€ä¾èµ–
pip install torch torchvision captcha pillow numpy

# å¯è§†åŒ–ä¾èµ–ï¼ˆæ¨èï¼‰
pip install tqdm matplotlib
```

## å¯è§†åŒ–åŠŸèƒ½

### 1. è¿›åº¦æ¡ï¼ˆtqdmï¼‰

#### æ•ˆæœå±•ç¤º

```
Epoch 1/150: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 782/782 [02:15<00:00, 5.76it/s]
  Loss: 0.0381, AvgLoss: 0.0452, LR: 0.000200, GPU: 0.23GB

================================================================================
Epoch [1/150] å®Œæˆ
  å¹³å‡Loss: 0.045234
  å½“å‰Loss: 0.038057
  å­¦ä¹ ç‡: 2.00e-04
  è€—æ—¶: 135.23ç§’
  æ˜¾å­˜ä½¿ç”¨: 0.23GB (å³°å€¼: 0.56GB)
  é¢„è®¡å‰©ä½™: 5å°æ—¶ 35åˆ†é’Ÿ
================================================================================
```

#### ä¿¡æ¯è¯´æ˜

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `Loss` | å½“å‰batchçš„æŸå¤±å€¼ |
| `AvgLoss` | å½“å‰epochçš„å¹³å‡æŸå¤± |
| `LR` | å½“å‰å­¦ä¹ ç‡ |
| `GPU` | GPUæ˜¾å­˜ä½¿ç”¨ï¼ˆA100ç‰ˆæœ¬æ˜¾ç¤ºå·²ç”¨/å·²ä¿ç•™ï¼‰ |
| `it/s` | æ¯ç§’å¤„ç†çš„batchæ•°ï¼ˆé€Ÿåº¦æŒ‡æ ‡ï¼‰ |
| `elapsed` | å·²ç”¨æ—¶é—´ |
| `remaining` | é¢„è®¡å‰©ä½™æ—¶é—´ |

### 2. è®­ç»ƒæ›²çº¿ï¼ˆmatplotlibï¼‰

#### ç”Ÿæˆçš„å›¾è¡¨

è®­ç»ƒè„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹æ›²çº¿ï¼š

##### æ ‡å‡†ç‰ˆï¼ˆ2å¼ å›¾ï¼‰

1. **Lossæ›²çº¿** - è®­ç»ƒæŸå¤±å˜åŒ–è¶‹åŠ¿
2. **å­¦ä¹ ç‡æ›²çº¿** - å­¦ä¹ ç‡è¡°å‡è¿‡ç¨‹

##### A100ä¼˜åŒ–ç‰ˆï¼ˆ4å¼ å›¾ï¼‰

1. **Lossæ›²çº¿** - è®­ç»ƒæŸå¤±å˜åŒ–è¶‹åŠ¿
2. **å­¦ä¹ ç‡æ›²çº¿** - å­¦ä¹ ç‡è¡°å‡è¿‡ç¨‹
3. **GPUæ˜¾å­˜ä½¿ç”¨** - æ˜¾å­˜å ç”¨å˜åŒ–
4. **ç´¯è®¡è®­ç»ƒæ—¶é—´** - æ—¶é—´ç»Ÿè®¡

#### ä¿å­˜ä½ç½®

```
training_logs/
â”œâ”€â”€ training_curves_20260202_143020.png      # æ¯10è½®æ›´æ–°
â”œâ”€â”€ training_curves_final_20260202_143020.png  # æœ€ç»ˆå®Œæ•´ç‰ˆ
â””â”€â”€ ...
```

### 3. è®­ç»ƒå†å²ï¼ˆJSONï¼‰

#### ä¿å­˜å†…å®¹

```json
{
  "epoch": [1, 2, 3, ...],
  "loss": [0.125, 0.098, 0.076, ...],
  "avg_loss": [0.152, 0.108, 0.081, ...],
  "lr": [0.0002, 0.00019998, 0.00019992, ...],
  "gpu_memory": [0.23, 0.23, 0.23, ...],  // A100ç‰ˆæœ¬
  "time": [135.2, 270.8, 406.1, ...]
}
```

#### ä½¿ç”¨åœºæ™¯

- åç»­åˆ†æè®­ç»ƒè¿‡ç¨‹
- ä¸å…¶ä»–å®éªŒå¯¹æ¯”
- ç»˜åˆ¶è‡ªå®šä¹‰å›¾è¡¨
- è®ºæ–‡æ•°æ®æ”¯æŒ

#### è¯»å–ç¤ºä¾‹

```python
import json

# è¯»å–è®­ç»ƒå†å²
with open('training_logs/training_history_20260202_143020.json', 'r') as f:
    history = json.load(f)

# åˆ†æè®­ç»ƒè¿‡ç¨‹
print(f"æœ€ä½Loss: {min(history['avg_loss'])}")
print(f"æœ€ä½³Epoch: {history['avg_loss'].index(min(history['avg_loss'])) + 1}")
```

### 4. è®­ç»ƒæ—¥å¿—ï¼ˆTXTï¼‰

#### æ—¥å¿—å†…å®¹

```text
è®­ç»ƒå¼€å§‹æ—¶é—´: 2026-02-02 14:30:20
æ€»è½®æ•°: 150
Batchå¤§å°: 64
åˆå§‹å­¦ä¹ ç‡: 0.0002
================================================================================

[2026-02-02 14:30:20] è®­ç»ƒå¼€å§‹
[2026-02-02 14:32:35] Epoch 1/150 - AvgLoss: 0.152340, LR: 2.00e-04, Time: 135.23s
[2026-02-02 14:34:50] ä¿å­˜æ£€æŸ¥ç‚¹: model_epoch_10.pkl
[2026-02-02 14:35:00] Epoch 10/150 - AvgLoss: 0.081234, LR: 1.98e-04, Time: 135.01s
...
```

#### ä¿å­˜ä½ç½®

```
training_logs/
â”œâ”€â”€ training_log_20260202_143020.txt
â””â”€â”€ ...
```

### 5. è®­ç»ƒæ€»ç»“

#### è®­ç»ƒç»“æŸæ—¶æ˜¾ç¤º

```
================================================================================
è®­ç»ƒæ€»ç»“
================================================================================
æ€»è®­ç»ƒæ—¶é—´: 5å°æ—¶ 35åˆ†é’Ÿ 42ç§’
è®­ç»ƒè½®æ•°: 150 / 150
æœ€ç»ˆLoss: 0.001234
æœ€ä½Loss: 0.001123 (Epoch 142)
æœ€ç»ˆå­¦ä¹ ç‡: 1.00e-06

æœ€ç»ˆæ˜¾å­˜ç»Ÿè®¡:
  å·²åˆ†é…: 0.23 GB
  å·²ä¿ç•™: 0.56 GB
  å³°å€¼: 0.68 GB
================================================================================
```

## ç›®å½•ç»“æ„

### è®­ç»ƒç”Ÿæˆçš„æ–‡ä»¶

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ model.pkl                    # æœ€ç»ˆæ¨¡å‹
â”œâ”€â”€ model_epoch_10.pkl           # æ£€æŸ¥ç‚¹ï¼ˆæ¯10è½®ï¼‰
â”œâ”€â”€ model_epoch_20.pkl
â”œâ”€â”€ ...
â””â”€â”€ training_logs/               # è®­ç»ƒæ—¥å¿—ç›®å½•
    â”œâ”€â”€ training_log_20260202_143020.txt          # æ–‡æœ¬æ—¥å¿—
    â”œâ”€â”€ training_history_20260202_143020.json     # è®­ç»ƒå†å²ï¼ˆJSONï¼‰
    â”œâ”€â”€ training_curves_20260202_143020.png       # è®­ç»ƒæ›²çº¿ï¼ˆæ›´æ–°ç‰ˆï¼‰
    â””â”€â”€ training_curves_final_20260202_143020.png # è®­ç»ƒæ›²çº¿ï¼ˆæœ€ç»ˆç‰ˆï¼‰
```

## ä½¿ç”¨è¯´æ˜

### æ ‡å‡†è®­ç»ƒ

```bash
# å®‰è£…ä¾èµ–
pip install tqdm matplotlib

# å¼€å§‹è®­ç»ƒï¼ˆè‡ªåŠ¨å¯ç”¨å¯è§†åŒ–ï¼‰
python captcha_train.py
```

### A100ä¼˜åŒ–è®­ç»ƒ

```bash
# å¼€å§‹è®­ç»ƒï¼ˆè‡ªåŠ¨å¯ç”¨å¯è§†åŒ–ï¼‰
python captcha_train_a100_optimized.py
```

### æ— å¯è§†åŒ–ä¾èµ–è¿è¡Œ

å¦‚æœæ²¡æœ‰å®‰è£… `tqdm` å’Œ `matplotlib`ï¼š

```bash
# ä»ç„¶å¯ä»¥è¿è¡Œï¼Œä½†ä¼šï¼š
# - ä¸æ˜¾ç¤ºè¿›åº¦æ¡ï¼ˆæ˜¾ç¤ºä¸ºæ™®é€šæ–‡æœ¬ï¼‰
# - ä¸ç”Ÿæˆè®­ç»ƒæ›²çº¿å›¾
# - å…¶ä»–åŠŸèƒ½æ­£å¸¸
python captcha_train.py
```

## è‡ªå®šä¹‰å¯è§†åŒ–

### ä¿®æ”¹è¿›åº¦æ¡æ ·å¼

ç¼–è¾‘è®­ç»ƒè„šæœ¬ä¸­çš„tqdmå‚æ•°ï¼š

```python
pbar = tqdm(enumerate(train_dataloader), total=total_steps, 
           desc=f'Epoch {epoch+1}/{num_epochs}',
           ncols=120,  # ä¿®æ”¹è¿›åº¦æ¡å®½åº¦
           bar_format='{l_bar}{bar}| {n_fmt}/{total_fmt} [{elapsed}<{remaining}]')
```

### ä¿®æ”¹å›¾è¡¨æ ·å¼

```python
# ä¿®æ”¹å›¾è¡¨å°ºå¯¸
fig, axes = plt.subplots(2, 1, figsize=(15, 10))  # å®½åº¦, é«˜åº¦

# ä¿®æ”¹çº¿æ¡æ ·å¼
axes[0].plot(epochs, losses, 'r-', linewidth=2, label='Loss')

# ä¿®æ”¹DPIï¼ˆæ¸…æ™°åº¦ï¼‰
plt.savefig(plot_file, dpi=150)  # é»˜è®¤100
```

### æ·»åŠ è‡ªå®šä¹‰æŒ‡æ ‡

```python
# åœ¨è®­ç»ƒå¾ªç¯ä¸­è®°å½•
history['custom_metric'] = []

# æ¯ä¸ªepochæ›´æ–°
history['custom_metric'].append(your_metric_value)

# ç»˜åˆ¶æ–°æ›²çº¿
axes[2].plot(history['epoch'], history['custom_metric'])
```

## æ€§èƒ½å½±å“

### tqdmè¿›åº¦æ¡

| å½±å“ | è¯´æ˜ |
|------|------|
| CPUå¼€é”€ | æä½ï¼ˆ<0.1%ï¼‰ |
| GPUå½±å“ | æ—  |
| è®­ç»ƒé€Ÿåº¦ | åŸºæœ¬æ— å½±å“ |
| æ¨è | âœ… å¼ºçƒˆæ¨è |

### matplotlibç»˜å›¾

| å½±å“ | è¯´æ˜ |
|------|------|
| CPUå¼€é”€ | ä½ï¼ˆä»…æ¯10è½®æ‰§è¡Œä¸€æ¬¡ï¼‰ |
| GPUå½±å“ | æ—  |
| è®­ç»ƒé€Ÿåº¦ | æ¯10è½®å¢åŠ 1-2ç§’ |
| æ¨è | âœ… æ¨è |

### æ€»ä½“å»ºè®®

- âœ… **æ¨èå®‰è£…æ‰€æœ‰å¯è§†åŒ–ä¾èµ–** - å½±å“æå°ï¼Œæ”¶ç›Šå¾ˆå¤§
- âœ… **å®šæœŸæŸ¥çœ‹è®­ç»ƒæ›²çº¿** - åŠæ—¶å‘ç°é—®é¢˜
- âœ… **ä¿ç•™è®­ç»ƒå†å²** - æ–¹ä¾¿åç»­åˆ†æ

## å¸¸è§é—®é¢˜

### Q1: è¿›åº¦æ¡ä¸æ˜¾ç¤ºï¼Ÿ

**æ£€æŸ¥ï¼š**
```bash
pip show tqdm
# å¦‚æœæ²¡æœ‰ï¼Œå®‰è£…ï¼š
pip install tqdm
```

### Q2: æ— æ³•ç”Ÿæˆè®­ç»ƒæ›²çº¿ï¼Ÿ

**æ£€æŸ¥ï¼š**
```bash
pip show matplotlib
# å¦‚æœæ²¡æœ‰ï¼Œå®‰è£…ï¼š
pip install matplotlib
```

### Q3: ä¸­æ–‡æ˜¾ç¤ºä¹±ç ï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š**
```python
# åœ¨ä»£ç å¼€å¤´æ·»åŠ 
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['SimHei', 'DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False
```

### Q4: è®­ç»ƒæ›²çº¿åœ¨å“ªé‡Œï¼Ÿ

**ä½ç½®ï¼š**
```
training_logs/training_curves_<æ—¶é—´æˆ³>.png
```

### Q5: å¦‚ä½•åªä¿å­˜æœ€ç»ˆæ›²çº¿ï¼Ÿ

**ä¿®æ”¹ä»£ç ï¼š**
```python
# æ³¨é‡Šæ‰æ¯10è½®ç»˜å›¾çš„éƒ¨åˆ†
# if (epoch+1) % 10 == 0:
#     plot_file = visualizer.plot_curves()
```

### Q6: å¦‚ä½•å®æ—¶æŸ¥çœ‹è®­ç»ƒæ›²çº¿ï¼Ÿ

**æ–¹å¼1ï¼šä½¿ç”¨å›¾ç‰‡æŸ¥çœ‹å™¨è‡ªåŠ¨åˆ·æ–°**
- Windows: ä½¿ç”¨Windowsç…§ç‰‡æŸ¥çœ‹å™¨
- Linux: `watch -n 10 eog training_logs/training_curves_*.png`

**æ–¹å¼2ï¼šä½¿ç”¨TensorBoardï¼ˆé«˜çº§ï¼‰**
```bash
# å®‰è£…
pip install tensorboard

# ä¿®æ”¹ä»£ç æ·»åŠ TensorBoardæ”¯æŒ
# è¿è¡Œ
tensorboard --logdir=training_logs
```

## é«˜çº§åŠŸèƒ½

### å®æ—¶ç›‘æ§ï¼ˆå¯é€‰ï¼‰

å¦‚æœæƒ³è¦æ›´é«˜çº§çš„å®æ—¶ç›‘æ§ï¼Œå¯ä»¥ä½¿ç”¨TensorBoardï¼š

```python
from torch.utils.tensorboard import SummaryWriter

writer = SummaryWriter('runs/experiment_1')

# åœ¨è®­ç»ƒå¾ªç¯ä¸­
writer.add_scalar('Loss/train', loss, epoch)
writer.add_scalar('LR', lr, epoch)
```

æŸ¥çœ‹ï¼š
```bash
tensorboard --logdir=runs
```

### Weights & Biasesé›†æˆï¼ˆå¯é€‰ï¼‰

```bash
pip install wandb

# åœ¨ä»£ç ä¸­
import wandb
wandb.init(project="captcha-recognition")
wandb.log({"loss": loss, "lr": lr})
```

## æ€»ç»“

### æ¨èé…ç½®

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pip install -r requirements.txt

# å¼€å§‹è®­ç»ƒï¼ˆè‡ªåŠ¨å¯ç”¨æ‰€æœ‰å¯è§†åŒ–ï¼‰
python captcha_train.py  # æˆ– captcha_train_a100_optimized.py
```

### é¢„æœŸæ•ˆæœ

- âœ… å®æ—¶è¿›åº¦æ¡æ˜¾ç¤º
- âœ… æ¯10è½®æ›´æ–°è®­ç»ƒæ›²çº¿
- âœ… å®Œæ•´è®­ç»ƒå†å²è®°å½•
- âœ… è¯¦ç»†è®­ç»ƒæ—¥å¿—
- âœ… é¢„è®¡å‰©ä½™æ—¶é—´
- âœ… æ˜¾å­˜ä½¿ç”¨ç›‘æ§ï¼ˆGPUï¼‰

### è¾“å‡ºæ–‡ä»¶

```
training_logs/
â”œâ”€â”€ ğŸ“Š training_curves_*.png      # è®­ç»ƒæ›²çº¿å›¾
â”œâ”€â”€ ğŸ“ training_log_*.txt         # æ–‡æœ¬æ—¥å¿—
â””â”€â”€ ğŸ“ˆ training_history_*.json    # JSONå†å²æ•°æ®
```

---

æ›´å¤šé—®é¢˜è¯·æŸ¥çœ‹å…¶ä»–æ–‡æ¡£æˆ–æIssueã€‚
